# sync_turn_off_delay_noloop.yaml
blueprint:
  name: "Ğ’Ñ‹ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ñ Ğ·Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ¾Ğ¹ (Ğ±ĞµĞ· Ñ†Ğ¸ĞºĞ»Ğ°)"
  description: "ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ Ñ‚ĞµĞºÑƒÑ‰ĞµĞµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ğ¿ĞµÑ€ĞµĞ´ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸ĞµĞ¼"
  domain: automation
  author: "Helper"
  input:
    trigger_entity:
      name: "ğŸ”˜ Ğ£ÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ¾-Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€"
      selector:
        entity:
    trigger_state:
      name: "ğŸ¯ Ğ¡Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ğ°"
      default: "off"
      selector:
        select:
          options:
            - "on"
            - "off"
    target_entity:
      name: "ğŸ’¡ Ğ¦ĞµĞ»ĞµĞ²Ğ¾Ğµ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ¾"
      selector:
        entity:
    delay_seconds:
      name: "â±ï¸ Ğ—Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ° (ÑĞµĞºÑƒĞ½Ğ´Ñ‹)"
      default: 0
      selector:
        number:
          min: 0
          max: 3600
          step: 1
          unit_of_measurement: "ÑĞµĞº"

trigger:
  - platform: state
    entity_id: !input trigger_entity
    to: !input trigger_state

condition:
  # ğŸ”¹ ĞĞµ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑÑ‚ÑŒ, ĞµÑĞ»Ğ¸ Ñ†ĞµĞ»ĞµĞ²Ğ¾Ğµ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ¾ ÑƒĞ¶Ğµ Ğ² Ğ½ÑƒĞ¶Ğ½Ğ¾Ğ¼ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğ¸
  - condition: template
    value_template: >-
      {% set target = input('target_entity') %}
      {% set trigger_state = input('trigger_state') %}
      {{ states(target) != trigger_state }}

action:
  - delay:
      seconds: !input delay_seconds
  - service: homeassistant.turn_off
    target:
      entity_id: !input target_entity

#mode: single
mode: restart
